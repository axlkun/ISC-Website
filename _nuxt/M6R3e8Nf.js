import{Q as C,a0 as F,a3 as H,a6 as $,z as s,c as R,g as X,aH as x,a7 as Y,a8 as Z,aI as j,ai as p,ae as ee,V as te,ak as ne,R as re,aa as y,r as D,H as z,aJ as ae,aK as se,e as M,ab as W,af as ie,M as oe,ax as le,ac as ue}from"./tyERN7c-.js";import{m as ce,u as ve}from"./B9oFmR4t.js";function de(e){return{aspectStyles:R(()=>{const i=Number(e.aspectRatio);return i?{paddingBottom:String(1/i*100)+"%"}:void 0})}}const q=C({aspectRatio:[String,Number],contentClass:String,inline:Boolean,...F(),...ce()},"VResponsive"),E=H()({name:"VResponsive",props:q(),setup(e,i){let{slots:r}=i;const{aspectStyles:t}=de(e),{dimensionStyles:c}=ve(e);return $(()=>{var l;return s("div",{class:["v-responsive",{"v-responsive--inline":e.inline},e.class],style:[c.value,e.style]},[s("div",{class:"v-responsive__sizer",style:t.value},null),(l=r.additional)==null?void 0:l.call(r),r.default&&s("div",{class:["v-responsive__content",e.contentClass]},[r.default()])])}),{}}}),ge=C({transition:{type:[Boolean,String,Object],default:"fade-transition",validator:e=>e!==!0}},"transition"),I=(e,i)=>{let{slots:r}=i;const{transition:t,disabled:c,group:l,...d}=e,{component:m=l?Y:Z,...S}=typeof t=="object"?t:{};return X(m,x(typeof t=="string"?{name:c?"":t}:S,typeof t=="string"?{}:Object.fromEntries(Object.entries({disabled:c,group:l}).filter(a=>{let[o,g]=a;return g!==void 0})),d),r)};function me(e,i){if(!j)return;const r=i.modifiers||{},t=i.value,{handler:c,options:l}=typeof t=="object"?t:{handler:t,options:{}},d=new IntersectionObserver(function(){var g;let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],S=arguments.length>1?arguments[1]:void 0;const a=(g=e._observe)==null?void 0:g[i.instance.$.uid];if(!a)return;const o=m.some(_=>_.isIntersecting);c&&(!r.quiet||a.init)&&(!r.once||o||a.init)&&c(o,m,S),o&&r.once?A(e,i):a.init=!0},l);e._observe=Object(e._observe),e._observe[i.instance.$.uid]={init:!1,observer:d},d.observe(e)}function A(e,i){var t;const r=(t=e._observe)==null?void 0:t[i.instance.$.uid];r&&(r.observer.unobserve(e),delete e._observe[i.instance.$.uid])}const fe={mounted:me,unmounted:A},Se=fe,_e=C({alt:String,cover:Boolean,color:String,draggable:{type:[Boolean,String],default:void 0},eager:Boolean,gradient:String,lazySrc:String,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},sizes:String,src:{type:[String,Object],default:""},crossorigin:String,referrerpolicy:String,srcset:String,position:String,...q(),...F(),...p(),...ge()},"VImg"),he=H()({name:"VImg",directives:{intersect:Se},props:_e(),emits:{loadstart:e=>!0,load:e=>!0,error:e=>!0},setup(e,i){let{emit:r,slots:t}=i;const{backgroundColorClasses:c,backgroundColorStyles:l}=ee(te(e,"color")),{roundedClasses:d}=ne(e),m=re("VImg"),S=y(""),a=D(),o=y(e.eager?"loading":"idle"),g=y(),_=y(),v=R(()=>e.src&&typeof e.src=="object"?{src:e.src.src,srcset:e.srcset||e.src.srcset,lazySrc:e.lazySrc||e.src.lazySrc,aspect:Number(e.aspectRatio||e.src.aspect||0)}:{src:e.src,srcset:e.srcset,lazySrc:e.lazySrc,aspect:Number(e.aspectRatio||0)}),b=R(()=>v.value.aspect||g.value/_.value||0);z(()=>e.src,()=>{P(o.value!=="idle")}),z(b,(n,u)=>{!n&&u&&a.value&&h(a.value)}),ae(()=>P());function P(n){if(!(e.eager&&n)&&!(j&&!n&&!e.eager)){if(o.value="loading",v.value.lazySrc){const u=new Image;u.src=v.value.lazySrc,h(u,null)}v.value.src&&se(()=>{var u;r("loadstart",((u=a.value)==null?void 0:u.currentSrc)||v.value.src),setTimeout(()=>{var f;if(!m.isUnmounted)if((f=a.value)!=null&&f.complete){if(a.value.naturalWidth||O(),o.value==="error")return;b.value||h(a.value,null),o.value==="loading"&&w()}else b.value||h(a.value),B()})})}}function w(){var n;m.isUnmounted||(B(),h(a.value),o.value="loaded",r("load",((n=a.value)==null?void 0:n.currentSrc)||v.value.src))}function O(){var n;m.isUnmounted||(o.value="error",r("error",((n=a.value)==null?void 0:n.currentSrc)||v.value.src))}function B(){const n=a.value;n&&(S.value=n.currentSrc||n.src)}let T=-1;M(()=>{clearTimeout(T)});function h(n){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;const f=()=>{if(clearTimeout(T),m.isUnmounted)return;const{naturalHeight:N,naturalWidth:U}=n;N||U?(g.value=U,_.value=N):!n.complete&&o.value==="loading"&&u!=null?T=window.setTimeout(f,u):(n.currentSrc.endsWith(".svg")||n.currentSrc.startsWith("data:image/svg+xml"))&&(g.value=1,_.value=1)};f()}const V=R(()=>({"v-img__img--cover":e.cover,"v-img__img--contain":!e.cover})),L=()=>{var f;if(!v.value.src||o.value==="idle")return null;const n=s("img",{class:["v-img__img",V.value],style:{objectPosition:e.position},src:v.value.src,srcset:v.value.srcset,alt:e.alt,crossorigin:e.crossorigin,referrerpolicy:e.referrerpolicy,draggable:e.draggable,sizes:e.sizes,ref:a,onLoad:w,onError:O},null),u=(f=t.sources)==null?void 0:f.call(t);return s(I,{transition:e.transition,appear:!0},{default:()=>[W(u?s("picture",{class:"v-img__picture"},[u,n]):n,[[ue,o.value==="loaded"]])]})},G=()=>s(I,{transition:e.transition},{default:()=>[v.value.lazySrc&&o.value!=="loaded"&&s("img",{class:["v-img__img","v-img__img--preload",V.value],style:{objectPosition:e.position},src:v.value.lazySrc,alt:e.alt,crossorigin:e.crossorigin,referrerpolicy:e.referrerpolicy,draggable:e.draggable},null)]}),J=()=>t.placeholder?s(I,{transition:e.transition,appear:!0},{default:()=>[(o.value==="loading"||o.value==="error"&&!t.error)&&s("div",{class:"v-img__placeholder"},[t.placeholder()])]}):null,K=()=>t.error?s(I,{transition:e.transition,appear:!0},{default:()=>[o.value==="error"&&s("div",{class:"v-img__error"},[t.error()])]}):null,Q=()=>e.gradient?s("div",{class:"v-img__gradient",style:{backgroundImage:`linear-gradient(${e.gradient})`}},null):null,k=y(!1);{const n=z(b,u=>{u&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{k.value=!0})}),n())})}return $(()=>{const n=E.filterProps(e);return W(s(E,x({class:["v-img",{"v-img--booting":!k.value},c.value,d.value,e.class],style:[{width:le(e.width==="auto"?g.value:e.width)},l.value,e.style]},n,{aspectRatio:b.value,"aria-label":e.alt,role:e.alt?"img":void 0}),{additional:()=>s(oe,null,[s(L,null,null),s(G,null,null),s(Q,null,null),s(J,null,null),s(K,null,null)]),default:t.default}),[[ie("intersect"),{handler:P,options:e.options},null,{once:!0}]])}),{currentSrc:S,image:a,state:o,naturalWidth:g,naturalHeight:_}}});function Ie(e,i){const r=D(),t=y(!1);if(j){const c=new IntersectionObserver(l=>{e==null||e(l,c),t.value=!!l.find(d=>d.isIntersecting)},i);M(()=>{c.disconnect()}),z(r,(l,d)=>{d&&(c.unobserve(d),t.value=!1),l&&c.observe(l)},{flush:"post"})}return{intersectionRef:r,isIntersecting:t}}export{he as V,Ie as u};
